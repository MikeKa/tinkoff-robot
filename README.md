# tinkoff-robot
Пример торгового робота для [Tinkoff Invest Api v2](https://tinkoff.github.io/investAPI/) на Node.js.
Робот не использует баз данных, ориентируется только на ответы API и файловый кеш.

## Подготовка
1. Склонируйте репозиторий
   ```
   git clone https://github.com/vitalets/tinkoff-robot.git
   ```
2. Установите зависимости
   ```
   cd tinkoff-robot && npm ci
   ```

## Переменные окружения
Создайте в корне файл `.env` и положите в него следующие переменные:
```
# Тинькоф API токен
TINKOFF_API_TOKEN=...
# ID боевого счете
REAL_ACCOUNT_ID=...
# ID счета в песочнице
SANDBOX_ACCOUNT_ID=...
```

> Для создания счета в песочнице запустите скрипт: `npx ts-node-esm scripts/create-account.ts`

> Для просмотра информации по всем счетам запустите скрипт: `npm run accounts`

## Конфигурация
Конфиг находится в файле [src/config.ts](), все поля с комментариями.
Роботу можно одновременно задать несколько figi с разными параметрами стратегии.

## Описание стратегии
Cтратегия использует комбинацию 3-х сигналов:

* отклонение текущей цены (takeProfit / stopLoss)
* пересечение скользящих средних (SMA)
* индекс относительной силы (RSI)

Код расчета сигналов находится в папке [/signals]().

После срабатывания сигнала на покупку или продажу, проверяется достаточно ли средств для этого действия.
Если средств достаточно, выставляется лимит-заявка.
При повторном сигнале заявка перевыставляется с более актуальной ценой.
Также алгоритм сейчас действует аккуратно: больше 1 заявки по одному инструменту не выставляет.

## Запуск
Запуск робота возможен в разных вариантах.

#### Запуск на рыночных данных в песочниц


## Бэктест

## Статистика

## Визуализация

## Автотесты
Для прогона локальных юнит-тестов запустите команду:
```
npm test
```
В процессе тестирования выполнится бэктест на заданных исторических свечах и проверка ожидаемой прибыли.

## Лицензия
Apache 2.0
